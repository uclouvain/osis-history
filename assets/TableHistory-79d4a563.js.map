{"version":3,"file":"TableHistory-79d4a563.js","sources":["../../frontend/utils.ts","../../frontend/components/TableHistory.vue"],"sourcesContent":["/*\n *\n *   OSIS stands for Open Student Information System. It's an application\n *   designed to manage the core business of higher education institutions,\n *   such as universities, faculties, institutes and professional schools.\n *   The core business involves the administration of students, teachers,\n *   courses, programs and so on.\n *\n *   Copyright (C) 2015-2022 Université catholique de Louvain (http://www.uclouvain.be)\n *\n *   This program is free software: you can redistribute it and/or modify\n *   it under the terms of the GNU General Public License as published by\n *   the Free Software Foundation, either version 3 of the License, or\n *   (at your option) any later version.\n *\n *   This program is distributed in the hope that it will be useful,\n *   but WITHOUT ANY WARRANTY; without even the implied warranty of\n *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *   GNU General Public License for more details.\n *\n *   A copy of this license - GNU General Public License - is available\n *   at the root of the source code of this program.  If not,\n *   see http://www.gnu.org/licenses/.\n *\n */\n\nexport function filterXssAndFormat (value: string) : string {\n  if (!value) return '';\n  const paragraphs = value.toString()\n    // replace newlines (CR and CRLF with only LF)\n    .replace(/\\r\\n|\\r/g, '\\n')\n    // escape tags\n    .replace(/</g, '&lt;').replace(/>/g, '&gt;')\n    // split double newlines to paragraphs\n    .split(/\\n{2,}/g);\n  // replace simple newlines with <br> and join with element with <p>\n  return paragraphs.map(p => '<p>' + p.replace(/\\n/g, '<br />') + '</p>', '').join('\\n\\n');\n}\n","<!--\n  -\n  -   OSIS stands for Open Student Information System. It's an application\n  -   designed to manage the core business of higher education institutions,\n  -   such as universities, faculties, institutes and professional schools.\n  -   The core business involves the administration of students, teachers,\n  -   courses, programs and so on.\n  -\n  -   Copyright (C) 2015-2021 Université catholique de Louvain (http://www.uclouvain.be)\n  -\n  -   This program is free software: you can redistribute it and/or modify\n  -   it under the terms of the GNU General Public License as published by\n  -   the Free Software Foundation, either version 3 of the License, or\n  -   (at your option) any later version.\n  -\n  -   This program is distributed in the hope that it will be useful,\n  -   but WITHOUT ANY WARRANTY; without even the implied warranty of\n  -   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n  -   GNU General Public License for more details.\n  -\n  -   A copy of this license - GNU General Public License - is available\n  -   at the root of the source code of this program.  If not,\n  -   see http://www.gnu.org/licenses/.\n  -\n  -->\n<template>\n  <table class=\"table table-striped\">\n    <thead v-if=\"!onHeadersRender\">\n      <tr>\n        <th>{{ $t('date') }}</th>\n        <th>{{ $t('message') }}</th>\n        <th>{{ $t('author') }}</th>\n      </tr>\n    </thead>\n    <thead\n        v-else\n        v-html=\"renderedHeaders\"\n    />\n\n    <tbody v-if=\"entries.length && !onItemRender\">\n      <tr\n          v-for=\"(entry, index) in entries\"\n          :key=\"index\"\n      >\n        <td>{{ entry.created }}</td>\n        <td v-html=\"filterXssAndFormat(entry.message)\" />\n        <td>{{ entry.author }}</td>\n      </tr>\n    </tbody>\n    <tbody\n        v-else-if=\"entries.length && !!onItemRender\"\n        v-html=\"renderedRows\"\n    />\n    <tbody\n        v-else-if=\"!!onHistoryEmptyRender\"\n        v-html=\"renderedEmpty\"\n    />\n    <tbody v-else>\n      <tr>\n        <td colspan=\"3\">\n          {{ $t('no_entry') }}\n        </td>\n      </tr>\n    </tbody>\n  </table>\n</template>\n\n<script lang=\"ts\">\nimport {defineComponent} from \"vue\";\nimport type {PropType} from \"vue\";\nimport type {Entry} from \"../interfaces\";\nimport {filterXssAndFormat} from \"../utils\";\n\nexport default defineComponent({\n  name: 'TableHistory',\n  props: {\n    entries: {\n      type: Array as PropType<Entry[]>,\n      required: true,\n    },\n    onItemRender: {\n      type: Function as PropType<(entry: Entry) => string>,\n      default: null,\n    },\n    onHeadersRender: {\n      type: Function as PropType<(entries: Entry[]) => string>,\n      default: null,\n    },\n    onHistoryEmptyRender: {\n      type: Function as PropType<(mode: string) => string>,\n      default: null,\n    },\n  },\n  data: function () {\n    return {\n      // Render dynamically the table headers and items\n      renderedHeaders: this.onHeadersRender ? this.onHeadersRender(this.entries) : '',\n      renderedRows: this.onItemRender ? this.entries.map(this.onItemRender).join('') : [],\n      renderedEmpty: this.onHistoryEmptyRender ? this.onHistoryEmptyRender('table') : '',\n    };\n  },\n  methods: {filterXssAndFormat},\n});\n</script>\n\n<style>\n.history-viewer .table {\n  background-color: #fff;\n}\n</style>\n"],"names":["filterXssAndFormat","value","p","__name","_sfc_main","defineComponent","_hoisted_7","_sfc_render","_ctx","_cache","$props","$setup","$data","$options","_createElementBlock","_hoisted_1","_openBlock","_hoisted_3","_hoisted_2","_createElementVNode","_toDisplayString","_hoisted_4","_Fragment","_renderList","entry","index","_hoisted_5","_hoisted_6","_hoisted_8"],"mappings":"qOA0BO,SAASA,EAAoBC,EAAwB,CAC1D,OAAKA,EACcA,EAAM,SAAA,EAEtB,QAAQ,WAAY;AAAA,CAAI,EAExB,QAAQ,KAAM,MAAM,EAAE,QAAQ,KAAM,MAAM,EAE1C,MAAM,SAAS,EAEA,IAASC,GAAA,MAAQA,EAAE,QAAQ,MAAO,QAAQ,EAAI,OAAQ,EAAE,EAAE,KAAK;AAAA;AAAA,CAAM,EATpE,EAUrB,CAXgBC,EAAAH,EAAA,sBC+ChB,MAAAI,EAAeC,EAAgB,CAC7B,KAAM,eACN,MAAO,CACL,QAAS,CACP,KAAM,MACN,SAAU,EACZ,EACA,aAAc,CACZ,KAAM,SACN,QAAS,IACX,EACA,gBAAiB,CACf,KAAM,SACN,QAAS,IACX,EACA,qBAAsB,CACpB,KAAM,SACN,QAAS,IACX,CACF,EACA,KAAM,UAAY,CACT,MAAA,CAEL,gBAAiB,KAAK,gBAAkB,KAAK,gBAAgB,KAAK,OAAO,EAAI,GAC7E,aAAc,KAAK,aAAe,KAAK,QAAQ,IAAI,KAAK,YAAY,EAAE,KAAK,EAAE,EAAI,CAAC,EAClF,cAAe,KAAK,qBAAuB,KAAK,qBAAqB,OAAO,EAAI,EAAA,CAEpF,EACA,QAAS,CAAC,mBAAAL,CAAkB,CAC9B,CAAC,4GA3CmBM,EAAA,CAAA,WAAA,qCAhCFC,EAAeC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAA,YAA7BC,EAMQ,QAAAC,EAAA,CALNP,EAAA,iBAQ0BQ,EAAA,EAAhBF,EAAe,QAAA,CAAA,IAAA,EAGd,UAAQN,EAAM,eAAA,EAA3B,KAAA,EAAAS,CAAA,IAXED,MAC2B,QAAlBE,EAAA,CAAAC,EACP,KAA4B,KAAA,CAC5BA,EAA2B,YAApBX,EAAE,GAAA,MAAA,CAAA,EAAA,CAAA,EAAAW,EAAA,KAAA,KAAAC,EAAAZ,EAAA,GAAA,SAAA,CAAA,EAAA,CAAA,oCAKe,CAAA,GAG5BA,EAAA,QAAA,QAAA,CACEA,EAEK,cAAAQ,IAAAF,EAAA,QAAAO,EAAA,EAEHL,EAAA,EAAA,EAAAF,EAA4BQ,OAArBC,EAAaf,EAAA,QAAA,CAAAgB,EAAAC,KACpBT,EAAiD,EAAAF,EAAA,KAAA,CAAA,IAAAW,GAAA,CAAAN,EAArC,YAAyBK,EAAO,OAAA,EAAA,CAAA,EAAAL,EAAA,KAAA,CAC5C,UAAAX,EAAA,mBAA2BgB,EAApB,OAAA,CAAA,EAAA,KAAA,EAAAE,CAAA,+BAII,EAAA,GAAA,EAAA,CAAA,GAAAlB,EAAA,QAAA,QAAAA,EAAA,cAAAQ,EAAA,EACHF,EAAY,QAAA,CAAA,IAAA,EAGP,UAAAN,EAAA,YADjB,EAAA,KAAA,EAAAmB,CAAA,GAAAnB,EAAA,sBAAAQ,EAAA,EAEYF,EAAa,QAAA,CAAA,IAAA,EAEzB,UAAAN,EAAA,aAAA,EACE,KAAA,EAAAF,CAIK,QADEQ,EAAA,QAAAc,EAAA,CAAAT,EAAA,KAAA,KAAA,wCAlCKhB,EAAAI,EAAA"}